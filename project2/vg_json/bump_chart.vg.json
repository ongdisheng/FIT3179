{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.1.0.json",
    "width": 600, 
    "height": 400,
    "title": "Rank of global child deaths by cause",
    "data": {
        "url": "https://raw.githubusercontent.com/ongdisheng/FIT3179/main/project2/data/bump_chart.csv"
    },
    "params": [
        {
            "name": "top_n",
            "value": 5,
            "bind": {
                "input": "range",
                "min": 1,
                "max": 17,
                "step": 1
            }
        }
    ],
    "transform": [{
        "sort": [
            {"field": "deaths", "order": "descending"}
        ],
        "window": [{
            "op": "rank",
            "as": "rank"
        }],
        "groupby": ["year"]
    },
        {"filter": "datum.rank <= top_n"}
    ],
    "encoding": {
        "x": {
            "field": "year",
            "type": "ordinal",
            "axis": {"labelAngle": 270, "labelFontSize": 12, "titleFontSize": 14},
            "title": "Year"
        },
        "y": {
            "field": "rank",
            "type": "quantitative",
            "sort": "descending",
            "scale": {"domain": [0.5, {"expr": "top_n + 0.5"}]},
            "axis": {
                "labelAngle": 0, 
                "labelFontSize": 12,
                "tickMinStep": 1,
                "tickCount": {"expr": "top_n"},
                "titleFontSize": 14
            },
            "title": "Rank"
        }
    },
    "layer": [
        {
            "mark": {"type": "line", "interpolate": "monotone"},
            "encoding": {
                "color": {
                    "field": "cause",
                    "legend": {
                        "title": "Cause"
                    }
                },
                "size": {
                    "condition": {
                        "param": "sel_cause_leg", "empty": false, "value": 3
                    },
                    "value": 1
                }
            }
        },
        {
            "params": [
                {
                    "name": "sel_cause_leg", "select": {"type": "point", "on": "click", "fields": ["cause"]},
                    "bind": "legend"
                }
            ],
            "mark": {"type": "tick", "thickness": 5},
            "encoding": {
                "color": {
                    "condition": {"param": "sel_cause_leg", "empty": false, "value": "black"},
                    "field": "cause"
                }
            }
        }
    ]

}
    
        


 
    
        
    
    